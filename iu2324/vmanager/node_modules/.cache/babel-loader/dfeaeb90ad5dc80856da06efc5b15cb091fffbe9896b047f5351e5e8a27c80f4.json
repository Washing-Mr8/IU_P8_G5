{"ast":null,"code":"import { createVNode as _createVNode, createElementVNode as _createElementVNode, withModifiers as _withModifiers, toDisplayString as _toDisplayString, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"container\"\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  class: \"invisible\"\n}, \"Submit\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"VModal\"], {\n    ref: \"modalRef\",\n    id: \"groupAddOrEditModal\",\n    title: $props.isAdd ? 'Añadiendo nuevo grupo' : `Editando grupo: ${$props.group.name}`\n  }, {\n    body: _withCtx(() => [_createElementVNode(\"form\", {\n      id: \"editOrAddGroup\",\n      onSubmit: _cache[0] || (_cache[0] = _withModifiers(e => $setup.setGroup(), [\"prevent\"]))\n    }, [_createElementVNode(\"div\", _hoisted_1, [_createVNode($setup[\"TextBox\"], {\n      start: $props.group.name,\n      id: \"g-name\",\n      label: \"nombre\"\n    }, null, 8 /* PROPS */, [\"start\"])]), _createElementVNode(\"div\", _hoisted_2, [_createVNode($setup[\"MemberBox\"], {\n      start: $props.group.members,\n      all: $setup.M.getVms(),\n      id: \"g-members\",\n      label: \"miembros\"\n    }, null, 8 /* PROPS */, [\"start\", \"all\"])]), _hoisted_3], 32 /* HYDRATE_EVENTS */)]),\n\n    footer: _withCtx(() => [_createElementVNode(\"button\", {\n      onClick: _cache[1] || (_cache[1] = _withModifiers(() => $setup.setGroup(), [\"prevent\"])),\n      class: \"btn btn-primary\"\n    }, _toDisplayString($props.isAdd ? 'Añadir este grupo' : `Confirmar cambios a ${$props.group.name}`), 1 /* TEXT */)]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"title\"]);\n}","map":{"version":3,"names":["class","_createElementVNode","type","_createBlock","$setup","ref","id","title","$props","isAdd","group","name","body","_withCtx","onSubmit","_cache","_withModifiers","e","setGroup","_hoisted_1","_createVNode","start","label","_hoisted_2","members","all","M","getVms","_hoisted_3","footer","onClick"],"sources":["C:\\hlocal\\IU_P8_G5\\IU_P8_G5\\iu2324\\vmanager\\src\\components\\GroupAddOrEditModal.vue"],"sourcesContent":["<script setup>\r\nimport VModal from './VModal.vue'\r\nimport TextBox from './TextBox.vue'\r\nimport MemberBox from './MemberBox.vue'\r\n\r\nimport * as M from '../model.js'\r\nimport { ref } from 'vue'\r\n\r\nconst emit = defineEmits(['add', 'edit'])\r\n\r\nconst props = defineProps({\r\n  group: Object,\r\n  isAdd: Boolean, // otherwise, editing existing instead of adding\r\n})\r\n\r\nlet modalRef = ref(null);\r\n\r\nfunction setGroup() {\r\n  const group = props.group;\r\n  const form = document.getElementById(\"editOrAddGroup\")\r\n  const valueFor = (name) => {\r\n    const input = form.querySelector(`input[name=${name}]`)\r\n    if (!input) console.log(\"ERROR: no input for name\", name, \"in\", form)\r\n    return input.value\r\n  }\r\n\r\n  console.log(\"saving group...\", group, form)\r\n\r\n  // comprueba validez de todos los campos, y sobreescribe resultado\r\n  if ( ! form.checkValidity()) {\r\n    // fuerza a que se muestren los errores simulando un envío\r\n    // (pero como hay errores, no se va a enviar nada :-)\r\n    form.querySelector(\"button[type=submit]\").click()\r\n    return; \r\n  }    \r\n\r\n  // todo válido: lanza evento a padre, y cierra modal\r\n  emit(props.isAdd ? 'add' : 'edit', new M.Group(group.id,\r\n    valueFor(\"g-name\"), JSON.parse(valueFor(\"g-members\"))\r\n  ))\r\n  modalRef.value.hide()    \r\n}\r\n\r\n// para que el padre pueda llamar a show (hide no debería hacer falta)\r\nfunction show() {\r\n  modalRef.value.show();\r\n}\r\ndefineExpose({ show });\r\n</script>\r\n\r\n<template>\r\n  <VModal ref=\"modalRef\" id=\"groupAddOrEditModal\"\r\n    :title=\"isAdd ? 'Añadiendo nuevo grupo' : `Editando grupo: ${group.name}`\" >\r\n    <template #body>\r\n      <form id=\"editOrAddGroup\" \r\n        @submit.prevent=\"e => setGroup()\">\r\n        <div class=\"container\">\r\n          <TextBox :start=\"group.name\" id=\"g-name\" label=\"nombre\" />\r\n        </div>\r\n        <div class=\"container\">\r\n          <MemberBox :start=\"group.members\" :all=\"M.getVms()\" id=\"g-members\" label=\"miembros\" />\r\n        </div>\r\n        <button type=\"submit\" class=\"invisible\">Submit</button>\r\n      </form>\r\n    </template>\r\n    <template #footer>\r\n      <button @click.prevent=\"() => setGroup()\" class=\"btn btn-primary\">\r\n        {{ isAdd ? 'Añadir este grupo' : `Confirmar cambios a ${group.name}` }}\r\n      </button>\r\n    </template>\r\n  </VModal>\r\n</template>\r\n\r\n<style scoped>\r\n</style>\r\n"],"mappings":";;EAwDaA,KAAK,EAAC;AAAW;;EAGjBA,KAAK,EAAC;AAAW;gCAGtBC,mBAAA,CAAuD;EAA/CC,IAAI,EAAC,QAAQ;EAACF,KAAK,EAAC;GAAY,QAAM;;;uBAXpDG,YAAA,CAmBSC,MAAA;IAnBDC,GAAG,EAAC,UAAU;IAACC,EAAE,EAAC,qBAAqB;IAC5CC,KAAK,EAAEC,MAAA,CAAAC,KAAK,gDAAgDD,MAAA,CAAAE,KAAK,CAACC,IAAI;;IAC5DC,IAAI,EAAAC,QAAA,CACb,MASO,CATPZ,mBAAA,CASO;MATDK,EAAE,EAAC,gBAAgB;MACtBQ,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,CAAUC,CAAC,IAAIb,MAAA,CAAAc,QAAQ;QAC9BjB,mBAAA,CAEM,OAFNkB,UAEM,GADJC,YAAA,CAA0DhB,MAAA;MAAhDiB,KAAK,EAAEb,MAAA,CAAAE,KAAK,CAACC,IAAI;MAAEL,EAAE,EAAC,QAAQ;MAACgB,KAAK,EAAC;0CAEjDrB,mBAAA,CAEM,OAFNsB,UAEM,GADJH,YAAA,CAAsFhB,MAAA;MAA1EiB,KAAK,EAAEb,MAAA,CAAAE,KAAK,CAACc,OAAO;MAAGC,GAAG,EAAErB,MAAA,CAAAsB,CAAC,CAACC,MAAM;MAAIrB,EAAE,EAAC,WAAW;MAACgB,KAAK,EAAC;iDAE3EM,UAAuD,C;;IAGhDC,MAAM,EAAAhB,QAAA,CACf,MAES,CAFTZ,mBAAA,CAES;MAFA6B,OAAK,EAAAf,MAAA,QAAAA,MAAA,MAAAC,cAAA,OAAgBZ,MAAA,CAAAc,QAAQ;MAAIlB,KAAK,EAAC;wBAC3CQ,MAAA,CAAAC,KAAK,gDAAgDD,MAAA,CAAAE,KAAK,CAACC,IAAI,mB"},"metadata":{},"sourceType":"module","externalDependencies":[]}