{"ast":null,"code":"import { ref, computed } from 'vue';\nimport { resolve } from '../model.js';\n\n// basado en https://vuejs.org/examples/#grid\n\nexport default {\n  __name: 'VmGrid',\n  props: {\n    data: Array,\n    columns: Array,\n    filterKey: String\n  },\n  emits: ['choose'],\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = __props;\n    const sortKey = ref('');\n    const sortOrders = ref(props.columns.reduce((o, key) => (o[key] = 1, o), {}));\n    const filteredData = computed(() => {\n      let {\n        data,\n        filterKey\n      } = props;\n      if (filterKey) {\n        filterKey = filterKey.toLowerCase();\n        data = data.filter(row => {\n          return Object.keys(row).some(key => {\n            return String(row[key]).toLowerCase().indexOf(filterKey) > -1;\n          });\n        });\n      }\n      const key = sortKey.value;\n      if (key) {\n        const order = sortOrders.value[key];\n        data = data.slice().sort((a, b) => {\n          a = a[key];\n          b = b[key];\n          return (a === b ? 0 : a > b ? 1 : -1) * order;\n        });\n      }\n      return data;\n    });\n    function sortBy(key) {\n      sortKey.value = key;\n      sortOrders.value[key] *= -1;\n    }\n    function capitalize(str) {\n      return str.charAt(0).toUpperCase() + str.slice(1);\n    }\n    const __returned__ = {\n      props,\n      sortKey,\n      sortOrders,\n      filteredData,\n      sortBy,\n      capitalize,\n      ref,\n      computed,\n      get resolve() {\n        return resolve;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","resolve","props","__props","sortKey","sortOrders","columns","reduce","o","key","filteredData","data","filterKey","toLowerCase","filter","row","Object","keys","some","String","indexOf","value","order","slice","sort","a","b","sortBy","capitalize","str","charAt","toUpperCase"],"sources":["C:/hlocal/IU_P8_G5/IU_P8_G5/iu2324/vmanager/src/components/VmGrid.vue"],"sourcesContent":["<script setup>\r\nimport { ref, computed } from 'vue'\r\nimport { resolve } from '../model.js'\r\n\r\n// basado en https://vuejs.org/examples/#grid\r\n\r\nconst props = defineProps({\r\n  data: Array,\r\n  columns: Array,\r\n  filterKey: String\r\n})\r\ndefineEmits(['choose'])\r\n\r\nconst sortKey = ref('')\r\nconst sortOrders = ref(\r\n  props.columns.reduce((o, key) => ((o[key] = 1), o), {})\r\n)\r\n\r\nconst filteredData = computed(() => {\r\n  let { data, filterKey } = props\r\n  if (filterKey) {\r\n    filterKey = filterKey.toLowerCase()\r\n    data = data.filter((row) => {\r\n      return Object.keys(row).some((key) => {\r\n        return String(row[key]).toLowerCase().indexOf(filterKey) > -1\r\n      })\r\n    })\r\n  }\r\n  const key = sortKey.value\r\n  if (key) {\r\n    const order = sortOrders.value[key]\r\n    data = data.slice().sort((a, b) => {\r\n      a = a[key]\r\n      b = b[key]\r\n      return (a === b ? 0 : a > b ? 1 : -1) * order\r\n    })\r\n  }\r\n  return data\r\n})\r\n\r\nfunction sortBy(key) {\r\n  sortKey.value = key\r\n  sortOrders.value[key] *= -1\r\n}\r\n\r\nfunction capitalize(str) {\r\n  return str.charAt(0).toUpperCase() + str.slice(1)\r\n}\r\n</script>\r\n\r\n<template>\r\n  <table v-if=\"filteredData.length\">\r\n    <thead>\r\n      <tr>\r\n        <th v-for=\"key in columns\" :key=\"key\"\r\n          @click=\"sortBy(key)\"\r\n          :class=\"{ active: sortKey == key }\">\r\n          {{ capitalize(key) }}\r\n          <span v-if=\"sortKey==key\" :class=\"`arrow ${sortOrders[key] > 0 ? 'asc' : 'dsc'}`\">\r\n          </span>\r\n        </th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr v-for=\"entry in filteredData\" :key=\"entry.id\" \r\n        @click=\"$emit('choose', entry.id)\">\r\n\r\n        <td v-for=\"key in columns\" :key=\"`_${entry.id}_${key}`\" class=\"text-start\">\r\n          <template v-if=\"key === 'name'\">\r\n            <span class=\"name\">{{entry[key]}}</span>\r\n          </template>\r\n          <template v-else-if=\"Array.isArray(entry[key])\">\r\n            {{entry[key].map(v => resolve(v).name).join(\", \")}}\r\n          </template>\r\n          <template v-else>\r\n            {{entry[key]}}\r\n          </template>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <p v-else>(no hay nada que mostrar)</p>\r\n</template>\r\n\r\n<style>\r\n.arrow.asc::after {\r\n  content: \"↓\"\r\n}\r\n.arrow.dsc::after {\r\n  content: \"↑\"\r\n}\r\nspan.name {\r\n  font-weight: 1000;\r\n}\r\ntable {\r\n  margin-top: 10px;\r\n\r\n}\r\nthead>tr {\r\n  border-bottom: 1px solid gray;\r\n  color: rgb(104, 103, 103);\r\n}\r\n</style>"],"mappings":"AACA,SAASA,GAAG,EAAEC,QAAQ,QAAQ,KAAK;AACnC,SAASC,OAAO,QAAQ,aAAa;;AAErC;;;;;;;;;;;;;;IAEA,MAAMC,KAAK,GAAGC,OAIZ;IAGF,MAAMC,OAAO,GAAGL,GAAG,CAAC,EAAE,CAAC;IACvB,MAAMM,UAAU,GAAGN,GAAG,CACpBG,KAAK,CAACI,OAAO,CAACC,MAAM,CAAC,CAACC,CAAC,EAAEC,GAAG,MAAOD,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,EAAGD,CAAC,CAAC,EAAE,CAAC,CAAC,CACxD,CAAC;IAED,MAAME,YAAY,GAAGV,QAAQ,CAAC,MAAM;MAClC,IAAI;QAAEW,IAAI;QAAEC;MAAU,CAAC,GAAGV,KAAK;MAC/B,IAAIU,SAAS,EAAE;QACbA,SAAS,GAAGA,SAAS,CAACC,WAAW,CAAC,CAAC;QACnCF,IAAI,GAAGA,IAAI,CAACG,MAAM,CAAEC,GAAG,IAAK;UAC1B,OAAOC,MAAM,CAACC,IAAI,CAACF,GAAG,CAAC,CAACG,IAAI,CAAET,GAAG,IAAK;YACpC,OAAOU,MAAM,CAACJ,GAAG,CAACN,GAAG,CAAC,CAAC,CAACI,WAAW,CAAC,CAAC,CAACO,OAAO,CAACR,SAAS,CAAC,GAAG,CAAC,CAAC;UAC/D,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ;MACA,MAAMH,GAAG,GAAGL,OAAO,CAACiB,KAAK;MACzB,IAAIZ,GAAG,EAAE;QACP,MAAMa,KAAK,GAAGjB,UAAU,CAACgB,KAAK,CAACZ,GAAG,CAAC;QACnCE,IAAI,GAAGA,IAAI,CAACY,KAAK,CAAC,CAAC,CAACC,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;UACjCD,CAAC,GAAGA,CAAC,CAAChB,GAAG,CAAC;UACViB,CAAC,GAAGA,CAAC,CAACjB,GAAG,CAAC;UACV,OAAO,CAACgB,CAAC,KAAKC,CAAC,GAAG,CAAC,GAAGD,CAAC,GAAGC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,IAAIJ,KAAK;QAC/C,CAAC,CAAC;MACJ;MACA,OAAOX,IAAI;IACb,CAAC,CAAC;IAEF,SAASgB,MAAMA,CAAClB,GAAG,EAAE;MACnBL,OAAO,CAACiB,KAAK,GAAGZ,GAAG;MACnBJ,UAAU,CAACgB,KAAK,CAACZ,GAAG,CAAC,IAAI,CAAC,CAAC;IAC7B;IAEA,SAASmB,UAAUA,CAACC,GAAG,EAAE;MACvB,OAAOA,GAAG,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAGF,GAAG,CAACN,KAAK,CAAC,CAAC,CAAC;IACnD"},"metadata":{},"sourceType":"module","externalDependencies":[]}